package qfmt

import (
	"fmt"
	"testing"
)

func Test_SMMUL(t *testing.T) {
	tests := []struct {
		op1, op2, result int32
	}{
		{0, 0, 0},
		{-1, -1, 0},
		{2147483647, 2147483647, 1073741823},
		{-2147483648, -2147483648, 1073741824},
		{2147483647, -2147483648, -1073741824},
		{-1, -2147483648, 0},
		{2147483647, -1, -1},
		{0, -1, 0},
		{469847548, 523840645, 57305498},
		{1791404762, 2101435147, 876495831},
		{1947422184, 2003110913, 908249669},
		{695507622, 1881709799, 304715593},
		{583229588, 454387517, 61702971},
		{1673509682, 1582833795, 616742223},
		{1841295872, 1651915321, 708192787},
		{1932155006, 1601323487, 720379220},
		{87174700, 1651982581, 33530193},
		{890207882, 954408187, 197817965},
		{279576856, 1430779761, 93135262},
		{1332672854, 1354534359, 420294508},
		{516560580, 244554157, 29412805},
		{1987663074, 1917988979, 887623957},
		{1672731440, 2004689833, 780752792},
		{2128338222, 1083531471, 536935740},
	}
	for _, v := range tests {
		r := smmul(v.op1, v.op2)
		if r != v.result {
			fmt.Printf("%+v %d (expected) %d (actual)\n", v, v.result, r)
			t.Error("FAIL")
		}
	}
}

func Test_SMMLA(t *testing.T) {
	tests := []struct {
		op1, op2, op3, result int32
	}{
		{0, 0, 469847548, 469847548},
		{-1, -1, 523840645, 523840645},
		{2147483647, 2147483647, 1791404762, -1429820711},
		{-2147483648, -2147483648, 2101435147, -1119790325},
		{2147483647, -2147483648, 1947422184, 873680360},
		{-1, -2147483648, 2003110913, 2003110913},
		{2147483647, -1, 695507622, 695507621},
		{0, -1, 1881709799, 1881709799},
		{583229588, 454387517, 1673509682, 1735212653},
		{1582833795, 1841295872, 1651915321, -1964475136},
		{1932155006, 1601323487, 87174700, 807553920},
		{1651982581, 890207882, 954408187, 1296810774},
		{279576856, 1430779761, 1332672854, 1425808116},
		{1354534359, 516560580, 244554157, 407465538},
		{1987663074, 1917988979, 1672731440, -1734611899},
		{2004689833, 2128338222, 1083531471, 2076940198},
		{1915976284, 1314607461, 1221369402, 1807813149},
		{1915828971, 1537990728, 640982753, 1327024576},
		{1339450374, 862362311, 1656928500, 1925869202},
		{1643857949, 1801763474, 1235754083, 1925361943},
		{751595616, 663308569, 202370526, 318445871},
	}
	for _, v := range tests {
		r := smmla(v.op1, v.op2, v.op3)
		if r != v.result {
			fmt.Printf("%+v %d (expected) %d (actual)\n", v, v.result, r)
			t.Error("FAIL")
		}
	}
}

func Test_SMMLS(t *testing.T) {
	tests := []struct {
		op1, op2, op3, result int32
	}{
		{0, 0, 469847548, 469847548},
		{-1, -1, 523840645, 523840644},
		{2147483647, 2147483647, 1791404762, 717662938},
		{-2147483648, -2147483648, 2101435147, 1027693323},
		{2147483647, -2147483648, 1947422184, -1273803289},
		{-1, -2147483648, 2003110913, 2003110912},
		{2147483647, -1, 695507622, 695507622},
		{0, -1, 1881709799, 1881709799},
		{583229588, 454387517, 1673509682, 1611806710},
		{1582833795, 1841295872, 1651915321, 973338481},
		{1932155006, 1601323487, 87174700, -633204521},
		{1651982581, 890207882, 954408187, 612005599},
		{279576856, 1430779761, 1332672854, 1239537591},
		{1354534359, 516560580, 244554157, 81642775},
		{1987663074, 1917988979, 1672731440, 785107482},
		{2004689833, 2128338222, 1083531471, 90122743},
		{1915976284, 1314607461, 1221369402, 634925654},
		{1915828971, 1537990728, 640982753, -45059071},
		{1339450374, 862362311, 1656928500, 1387987797},
		{1643857949, 1801763474, 1235754083, 546146222},
		{751595616, 663308569, 202370526, 86295180},
	}
	for _, v := range tests {
		r := smmls(v.op1, v.op2, v.op3)
		if r != v.result {
			fmt.Printf("%+v %d (expected) %d (actual)\n", v, v.result, r)
			t.Error("FAIL")
		}
	}
}
